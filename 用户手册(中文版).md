# 📘 ACL-GPU-00 服务器使用指南

> **服务器 IP:** `10.198.119.245`
> **硬件配置:** 4x NVIDIA RTX 5090 | AMD EPYC 9254 | 256GB 内存
> **物理位置:** Hwlab X235

欢迎使用 Hwlab 高性能计算节点。
**请注意：** 本服务器为实验室共享资源。**普通用户没有 `sudo` (管理员) 权限。** 所有软件和工具的安装必须通过 Conda 管理，或安装在您的用户主目录下。

---

## 🛑 步骤 1：首次登录与安全设置（必做）

### 1.1 通过 SSH 登录

**首先必须登录DTU HPC作为跳板！**
请参考 DTU HPC 官方指南登录跳板机（如有）：[https://www.hpc.dtu.dk/?page_id=2501](https://www.hpc.dtu.dk/?page_id=2501)

在您的终端中运行以下命令连接服务器：

```bash
ssh username@10.198.119.245

```

* **默认初始密码:** `ChangeMeNow` (或者管理员提供的临时密码)

### 1.2 立即修改密码！

出于安全考虑，**首次登录后必须立即修改密码**。
在服务器终端运行：

```bash
passwd

```

* 输入当前密码。
* 输入两次新密码（建议包含大小写字母和数字）。
* *(注意：输入密码时屏幕上不会显示任何字符，这是正常的，输完回车即可)*。

---

## 🔑 步骤 2：配置 SSH 密钥（推荐）

配置 SSH 密钥后，登录服务器将不再需要输入密码。

### 2.1 生成密钥对（在您的本地电脑上）

*请在**您自己的电脑**（本地终端）运行，不要在服务器上跑：*

```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
# 一路按回车使用默认设置即可

```

### 2.2 将公钥复制到服务器

*继续在**您自己的电脑**上运行：*

```bash
ssh-copy-id username@10.198.119.245

```

* 输入一次服务器密码。
* **成功：** 现在您可以免密登录了。

---

## 🐙 步骤 3：Github 配置

为了方便从 Github 拉取代码，建议将服务器的 SSH Key 添加到您的 Github 账户。

### 3.1 生成服务器密钥（在服务器上）

*请在**服务器终端**运行：*

```bash
ssh-keygen -t ed25519 -C "hwlab_server_key"
# 一路按回车

```

### 3.2 获取公钥内容

```bash
cat ~/.ssh/id_ed25519.pub

```

* **复制** 输出的内容（以 `ssh-ed25519` 开头的那一串）。

### 3.3 添加到 Github

1. 登录 Github，进入 [SSH 设置页面](https://github.com/settings/keys)。
2. 点击 **New SSH key**。
3. **Title:** 填 `Hwlab Server`。
4. **Key:** 粘贴刚才复制的内容。
5. **测试:** 在服务器输入 `ssh -T git@github.com`（看到 Hi username! 即成功）。

---

## 🐍 步骤 4：Python 环境配置 (Conda)

由于没有 Root 权限，**Miniconda** 是您管理 Python 环境的唯一途径。请勿使用系统自带的 Python。

### 4.1 安装 Miniconda

```bash
mkdir -p ~/miniconda3
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda3/miniconda.sh
bash ~/miniconda3/miniconda.sh -b -u -p ~/miniconda3
rm -rf ~/miniconda3/miniconda.sh

# 初始化 Shell
~/miniconda3/bin/conda init bash
source ~/.bashrc

```

### 4.2 创建实验环境

**严禁**直接在 `base` 环境中跑实验。

```bash
# 创建一个名为 'lab_env' 的新环境
conda create -n lab_env python=3.10

# 激活环境
conda activate lab_env

# 安装 Pytorch (示例)
pip install torch torchvision torchaudio

```

---

## 🖥️ 步骤 5：进程管理与 GUI 禁令

### ⚠️ 严禁安装图形界面 (STRICT NO-GUI)

**禁止** 安装任何桌面环境 (Gnome, XFCE) 或远程桌面工具 (TeamViewer, VNC, ToDesk)。

* **原因:** 图形界面会占用宝贵的显存 (VRAM) 和内存，并可能导致驱动不稳定。
* **后果:** 违反此规定的账号将被**暂停使用**。

### ✅ 使用 Tmux (后台运行)

请务必使用 **Tmux** 来运行训练任务，防止网络断开导致训练中断。
由于没有 sudo 权限，请通过 Conda 安装 Tmux：

**安装 Tmux (用户级):**

```bash
# 确保你已激活 conda 环境
conda install -c conda-forge tmux

```

**Tmux 常用指令速查:**

* `tmux new -s exp1`: 创建一个叫 "exp1" 的新会话。
* **挂起 (保持后台运行):** 按下 `Ctrl + B`，松开，再按 `D`。
* `tmux attach -t exp1`: 重新进入刚才的会话。
* `tmux ls`: 查看当前所有会话。

---

## 📊 步骤 6：系统监控工具

运行代码前，**必须**检查资源占用情况，避免挤占他人正在运行的任务。

### 6.1 安装工具 (无需 Sudo)

我们使用 Conda 和 Pip 将监控工具安装到您的用户目录下。

```bash
# 安装 CPU/内存监控工具
conda install -c conda-forge htop btop

# 安装 GPU 监控神器 (强烈推荐)
pip install nvitop

```

### 6.2 如何查看

* **`nvitop`:** 实时查看 GPU 显存和利用率。**强制要求：运行 `python train.py` 前必须先看一眼！**
* 启动命令: `nvitop -m` (彩色全屏模式)


* **`btop`:** 查看 CPU 和 内存 占用情况。
* 启动命令: `btop`



---

## 📂 附录：存储规范与文件传输

### 存储规范

* **`/home/username/`**: 仅用于存放 **代码 (Code)** 和 **脚本 (Scripts)**。
* **大型数据集**: **严禁** 将大型数据集 (如 ImageNet) 解压到 home 目录。
* 请使用 **`/archive`** 或 **`/work`** 目录（具体路径请咨询管理员）。


* **临时文件**: 实验结束后请及时清理临时文件。

### 文件传输 (SCP)

从您的**本地电脑**传输文件到服务器：

```bash
# 上传单个文件
scp local_file.zip username@10.198.119.245:~/

# 上传整个文件夹
scp -r local_folder username@10.198.119.245:~/

```
